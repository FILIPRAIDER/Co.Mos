# üîß Configuraci√≥n de Variables de Entorno en Railway

## Variables de Redis Configuradas

```bash
UPSTASH_REDIS_REST_URL="https://precious-scorpion-34779.upstash.io"
UPSTASH_REDIS_REST_TOKEN="AYfbAAIncDI3ZGIwZGIyNDMyZmI0ODc3YTE2YTRmYzVjYzM3YjkyMnAyMzQ3Nzk"
```

## Pasos para A√±adir en Railway

### 1. Acceder a tu Proyecto en Railway
- Ve a https://railway.app/dashboard
- Selecciona tu proyecto "Co.Mos"
- Click en el servicio de tu aplicaci√≥n

### 2. Ir a la Pesta√±a de Variables
- Click en la pesta√±a **"Variables"**
- Ver√°s las variables existentes (DATABASE_URL, NEXTAUTH_URL, etc.)

### 3. A√±adir las Nuevas Variables
Click en **"+ New Variable"** y a√±ade cada una:

**Variable 1:**
```
Name: UPSTASH_REDIS_REST_URL
Value: https://precious-scorpion-34779.upstash.io
```

**Variable 2:**
```
Name: UPSTASH_REDIS_REST_TOKEN
Value: AYfbAAIncDI3ZGIwZGIyNDMyZmI0ODc3YTE2YTRmYzVjYzM3YjkyMnAyMzQ3Nzk
```

### 4. Guardar y Desplegar
- Railway detectar√° los cambios autom√°ticamente
- Click en **"Deploy"** o espera el auto-deploy
- El deploy tomar√° ~2-3 minutos

### 5. Verificar en los Logs
Una vez termine el deploy, ve a la pesta√±a **"Deployments"** ‚Üí **"View Logs"**

**Antes (sin Redis):**
```
‚ö†Ô∏è Redis no configurado. Rate limiting y caching deshabilitados.
```

**Despu√©s (con Redis):**
```
‚úÖ Rate limiting activo
‚úÖ Cache de √≥rdenes configurado
```

## Verificaci√≥n Local (Opcional)

Si quieres probar localmente antes del deploy:

1. Crea/edita `.env.local`:
```bash
UPSTASH_REDIS_REST_URL="https://precious-scorpion-34779.upstash.io"
UPSTASH_REDIS_REST_TOKEN="AYfbAAIncDI3ZGIwZGIyNDMyZmI0ODc3YTE2YTRmYzVjYzM3YjkyMnAyMzQ3Nzk"
```

2. Reinicia el servidor:
```bash
npm run dev
```

3. Ver√°s en la consola:
```
‚úÖ Redis conectado exitosamente
```

## ‚úÖ Checklist

- [ ] Variables a√±adidas en Railway
- [ ] Deploy completado
- [ ] Logs verificados (sin warnings de Redis)
- [ ] Probar crear una orden en producci√≥n
- [ ] Verificar headers de rate limit:
  ```
  X-RateLimit-Limit: 10
  X-RateLimit-Remaining: 9
  X-RateLimit-Reset: [timestamp]
  ```

## üîí Seguridad

- ‚úÖ **Nunca commitear** estas variables al repositorio
- ‚úÖ `.env.local` est√° en `.gitignore`
- ‚úÖ Solo existen en Railway y tu m√°quina local

## üéâ ¬°Listo!

Una vez a√±adidas las variables y desplegado, tu aplicaci√≥n tendr√°:
- ‚úÖ Rate limiting activo (10 req/min por IP)
- ‚úÖ Cache de √≥rdenes (30 segundos)
- ‚úÖ Idempotency keys (24 horas)
- ‚úÖ Protecci√≥n contra DDoS
- ‚úÖ Performance mejorado

---

**Fecha de configuraci√≥n:** Nov 7, 2024  
**Regi√≥n de Upstash:** Detectada autom√°ticamente  
**Plan:** FREE (10,000 comandos/d√≠a)
